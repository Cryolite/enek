#!/usr/bin/env bash

SOURCE_DIR="$(dirname "$(readlink -e "${BASH_SOURCE[0]}")")"
. "$SOURCE_DIR/../util/common.sh"

opts="$(getopt -n "$SOURCE_PATH_RELATIVE" -l docker -- '' "$@")"
eval set -- "$opts"

while test "$#" -ne 0; do
  arg="$1"
  shift
  case "$arg" in
  '--docker')
    docker=yes
    ;;
  '--')
    ;;
  *)
    print_error_message "error: An invalid argument \`$arg'."
    exit 1
    ;;
  esac
done

if ! test -v docker; then
  print_error_message "error: Bootstrap procedure is not implemented other than Docker."
  exit 1
fi

docker pull cryolite/enek-build:latest
docker/build/build.sh --cache-from=cryolite/enek-build:latest
